---
title: "Research Analysis Notebook"
---

```{r}
#| label: setup
#| include: false
library(here)
source(here("utils","check_packages.R"))
source(here("utils","functions.R"))
```

```{r}
#| label: data load
load(here("data","data_constructed","analytical_data.RData"))
```

```{r}
#| label: tbl-multi-models
#| fig-cap: Multinomial Models
model1 <- multinom(race_response~HomelandP,
                  data=subset(DATA, race_ancestry=="AIAN/White"))
model2 <- multinom(race_response~HomelandP+EducA,
                   data = subset(DATA, race_ancestry=="AIAN/White"))
model3 <- multinom(race_response~HomelandP+EducA+Gender,
                   data = subset(DATA, race_ancestry=="AIAN/White"))
knitreg(list(model1,model2,model3),
          digits=3)
```

```{r}
#| label: fig-race-ancestry
#| fig-cap: Comparing listed ancestry and race classification
ggplot(data = DATA, aes(x = race_response, fill = race_ancestry, group=race_ancestry, y=after_stat(prop))) + 
  geom_bar(position = "dodge")+
  scale_y_continuous(labels = scales::percent)+
  labs(x=NULL, y=NULL, fill="Race")
```
