---
title: "Research Analysis Notebook"
editor_options: 
  chunk_output_type: inline
---

```{r}
#| label: setup
#| include: false
library(here)
source(here("utils","check_packages.R"))
source(here("utils","functions.R"))
```

```{r}
#| label: data load
load(here("data","data_constructed","analytical_data.RData"))
```

```{r}
# Produce table of race response and race ancestry before dropping!
table(DATA$race_ancestry,DATA$race_response,exclude = NULL)
```

```{r}
# label: drop-responses
DATA$race_response <- droplevels(DATA$race_response)
DATA <- subset(DATA, race_response %in% c("Other Race Alone", 
                                          "Indigenous Alone",
                                        "Multiracial"))
```

```{r}
#| label: tbl-multi-models
#| tbl-cap: Multinomial Models
#| results: asis
model1 <- multinom(race_response~MetroC,
                  data=subset(DATA, race_ancestry=="Indigenous/White"))
model2 <- update(model1, .~.+HomelandP)
model3 <- update(model2, .~.+EducA+Gender+Hispanic)
modelsummary(list(model1,model2,model3),
             digits=3, shape = term ~ model+response, stars = TRUE)
```
Looking at model 1, those who listed their ancestry as "Indigenous/White"
```{r}

model4 <- multinom(race_response~MetroC,
                  data=subset(DATA, race_ancestry=="Indigenous/Black"))
model5 <- update(model4, .~.+HomelandP)
model6 <- update(model5, .~.+EducA+Gender+Hispanic)
modelsummary(list(model4,model5,model6),
             digits=3, shape = term ~ model+response, stars = TRUE)
```

```{r}
model7 <- multinom(race_response~MetroC,
                  data=subset(DATA, race_ancestry=="Indigenous/Asian"))
model8 <- update(model7, .~.+HomelandP)
model9 <- update(model8, .~.+EducA+Gender+Hispanic)
modelsummary(list(model7,model8,model9),
             digits=3, shape = term ~ model+response, stars = TRUE)
```

```{r}
#| label: fig-race-ancestry
#| fig-cap: Comparing listed ancestry and race classification
ggplot(data = DATA, aes(x = race_response, fill = race_ancestry, group=race_ancestry, y=after_stat(prop))) + 
  geom_bar(position = "dodge") +
  scale_y_continuous(labels = scales::percent) +
  labs(x = "Self-Identified Racial Classification", y = NULL, fill = "Ancestry")+
  theme(axis.title.x = element_text(vjust = -1)) 
```

In @fig-race-ancestry 72% of respondents who list Indigenous and Asian ancestry did not self-identify as Indigenous or Asian in regards to their racial identity. \^[Does this challenge previous research that suggests that those with part Asian ancestry tend to favor a multiracial identity @gullickson_choosing_2011. This can help lead to some future analysis and inform the inclusion of more literature on multiracial identity amongst mixed-race Asians]

After update 3/21/2024

inconsistency reduced by 30% cc
